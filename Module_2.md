# –ú–æ–¥—É–ª—å 2: –°–∏—Å—Ç–µ–º–Ω–æ–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ (1.5 —á–∞—Å–∞)

## üìã –ó–∞–¥–∞–Ω–∏–µ 1: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ–º–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä Samba –Ω–∞ –º–∞—à–∏–Ω–µ BR-SRV.

**–ó–∞–¥–∞–Ω–∏–µ 1**:
- –°–æ–∑–¥–∞–π—Ç–µ 5 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –æ—Ñ–∏—Å–∞ HQ: –∏–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Ñ–æ—Ä–º–∞—Ç–∞ user‚Ññ.hq. –°–æ–∑–¥–∞–π—Ç–µ –≥—Ä—É–ø–ø—É hq, –≤–≤–µ–¥–∏—Ç–µ –≤ —ç—Ç—É –≥—Ä—É–ø–ø—É —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –í–≤–µ–¥–∏—Ç–µ –≤ –¥–æ–º–µ–Ω –º–∞—à–∏–Ω—É HQ-CLI
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≥—Ä—É–ø–ø—ã hq –∏–º–µ—é—Ç –ø—Ä–∞–≤–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –ü–ö
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≥—Ä—É–ø–ø—ã hq –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–≤—ã—à–∞—Ç—å –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –∫–æ–º–∞–Ω–¥: cat, grep, id. –ó–∞–ø—É—Å–∫–∞—Ç—å –¥—Ä—É–≥–∏–µ –∫–æ–º–∞–Ω–¥—ã —Å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–º–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≥—Ä—É–ø–ø—ã –Ω–µ –∏–º–µ—é—Ç –ø—Ä–∞–≤–∞
- –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∏–º–ø–æ—Ä—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ —Ñ–∞–π–ª–∞ users.csv. –§–∞–π–ª –±—É–¥–µ—Ç —Ä–∞—Å–ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ BR-SRV –≤ –ø–∞–ø–∫–µ /opt

> **–í–∞–∂–Ω–æ**: –î–ª—è –∏–º–ø–æ—Ä—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ users.csv –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç, –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ —è –Ω–µ –Ω–∞—à–µ–ª —Å–∫—Ä–∏–ø—Ç–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ –±—ã –ø–µ—Ä–µ–Ω–æ—Å–∏–ª–∏ –≤—Å–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–ª–∞–≥–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–æ—Ç–æ—Ä—ã–µ —É–∫–∞–∑–∞–Ω—ã –≤ /opt/users.csv, –ø–æ—ç—Ç–æ–º—É —è –Ω–∞–ø–∏—Å–∞–ª —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç, –µ–≥–æ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ [—Ç—É—Ç](https://github.com/meowehh/samba-import).

### BR-SRV
```bash
apt-get update && apt-get install -y task-samba-dc alterator-fbi alterator-net-domain admx-* admc gpui
```
```bash
vim /etc/sysconfig/network
HOSTNAME=br-srv.au-team.irpo
```
```bash
reboot
```
```bash
systemctl enable --now ahttpd alteratord
rm -rf /etc/samba/smb.conf /var/{lib.cache}/samba
mkdir -p /var/lib/samba/sysvol
```
```bash
rm -rf /etc/net/ifaces/ens18/resolv.conf
systemctl restart network
vim /etc/resolvconf.conf
name_servers=127.0.0.1
name_servers=192.168.1.10
resolvconf -u
systemctl restart network
```
```bash
samba-tool domain provision --realm=au-team.irpo --domain=au-team --adminpass='P@ssw0rd' --dns-backend=BIND9_DLZ --server-role=dc --use-rfc2307 
```

### HQ-CLI
```bash
apt-get update && apt-get install -y admx-* admc gpui sudo gpupdate
```
**–ó–∞—Ö–æ–¥–∏–º —á–µ—Ä–µ–∑ –≤–∫–ª–∞–¥–∫—É Console –≤–Ω—É—Ç—Ä–∏ Proxmox VE, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π —á–∞—Å—Ç–∏.**
```
login: user
password: resu
```
**–û—Ç–∫—Ä—ã–≤–∞–µ–º Firefox:** 
- –ü–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ –∞–¥—Ä–µ—Å—É 192.168.3.10:8080
- –î–∞–Ω–Ω—ã–µ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:
```bash
login: root
password: toor
```
- Configuration > Expert mode > Apply
- Web Interface
- –ú–µ–Ω—è–µ–º –ø–æ—Ä—Ç 8080 –Ω–∞ 8081 > Apply > Restart http server
- –ü–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ –∞–¥—Ä–µ—Å—É 192.168.3.10:8081
- –í–∫–ª–∞–¥–∫–∞ Domain
- –í—ã–±–∏—Ä–∞–µ–º Active Directory Domain Controller
- DNS Forwarders - 192.168.1.10
- Domain - au-team.irpo
- Password - P@ssw0rd
- Apply
- –ó–∞–ø—É—Å–∫–∞–µ–º –∏ –¥–æ–∂–∏–¥–∞–µ–º—Å—è —Å–æ—Å—Ç–æ—è–Ω–∏—è - OK.

### BR-SRV:
**–ü–µ—Ä–µ–ø—É—Å–∫–∞–µ–º —Å–∏—Å—Ç–µ–º—É –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º**:
```bash
ping ya.ru
ping br-srv.au-team.irpo
ping hq-rtr.au-team.irpo
```
> –ï—Å–ª–∏ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - —Ç–æ –û–ö!

### HQ-CLI:
**–ü–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä—è–µ–º 192.168.3.10:8081**
- –ó–∞—Ö–æ–¥–∏–º –≤ Domain
> –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å OK, —Ç–æ –∏–¥–µ–º –¥–∞–ª—å—à–µ.

**–û—Ç —Ä—É—Ç–∞ –≤—ã–ø–æ–ª–Ω—è–µ–º:**
```bash
nmcli con modify CLI-NET \
	ipv4.method auto \
	ipv4.ignore-auto-dns yes \
	ipv4.dns 192.168.3.10
```
```bash
nmcli con down CLI-NET
nmcli con up CLI-NET
```
**–û—Ç–∫—Ä—ã–≤–∞–µ–º —Å–Ω–æ–≤–∞ GUI –∏ –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª, —Ç–∞–º –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º**:
```bash
acc
```
- –ü–∞—Ä–æ–ª—å toor
- –í—ã–±—Ä–∞—Ç—å Auth –≤ Networking
- –ü—Ä–æ–ø–∏—Å–∞—Ç—å –≤ Domain - au-team.irpo
- –ü—Ä–æ–ø–∏—Å–∞—Ç—å –≤ Workgroup - au-team
- Apply
- Login: Administrator, Password: P@ssw0rd
> –ï—Å–ª–∏ –≤—Ö–æ–¥ –≤ –¥–æ–º–µ–Ω –ø—Ä–æ–∏–∑–æ—à–µ–ª, —Ç–æ - –û–ö!

### BR-SRV
```bash
samba-tool group add hq
for i in $(seq 1 5); do samba-tool user add user$i.hq 'P@ssw0rd'; done
for i in $(seq 1 5); do samba-tool group addmembers hq user$i.hq; done
```
–ü—Ä–æ–≤–µ—Ä–∏–º –Ω–∞–ª–∏—á–∏–µ –≥—Ä—É–ø–ø—ã hq –≤ Samba, –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
```bash
samba-tool group list
samba-tool group listmembers hq
```
```bash
admx-msi-setup
```
### HQ-CLI

**–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –∏ –≤—Ö–æ–¥–∏–º –∫–∞–∫ Administrator**:
- –ü–∞—Ä–æ–ª—å: P@ssw0rd

**–û—Ç–∫—Ä—ã–≤–∞–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª**:
```bash
su -
toor
```
```bash
admx-msi-setup
```
```bash
roleadd hq wheel
```
```bash
rolelst
```
> **–ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ hq:wheel**
**–î–æ–±–∞–≤–ª—è–µ–º –≤ sudoers –¥–∞–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏:**
```bash
mcedit /etc/sudoers
, %AU-TEAM\\hq
Cmnd_Alias	SHELLCMD = /usr/bin/id, /bin/cat, /bin/grep
SHELLCMD
```
–î–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –≥–¥–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏, –∏ –∫—É–¥–∞ –∏—Ö –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å - –ø—Ä–∏–º–µ—Ä —Ç–æ–≥–æ –∫–∞–∫ —ç—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —É –º–µ–Ω—è:
```bash
## User alias specification
##
## Groups of users.  These may consist of user names, uids, Unix groups,
## or netgroups.
# User_Alias ADMINS = millert, dowdy, mikef
User_Alias WHEEL_USERS = %wheel, AU-TEAM\\hq # –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞
User_Alias XGRP_USERS = %xgrp
# User_Alias SUDO_USERS = %sudo

##
## Runas alias specification
##
Cmnd_Alias SHELLCMD = /usr/bin/id, /bin/cat, /bin/grep # –í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞
##
## User privilege specification
##
# root ALL=(ALL:ALL) ALL

## Uncomment to allow members of group wheel to execute any command
WHEEL_USERS ALL=(ALL:ALL) SHELLCMD # –¢—Ä–µ—Ç—å—è —Å—Ç—Ä–æ–∫–∞
```
```
exit
```
**–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –≤—ã—à–ª–∏ –∏–∑ –ø–æ–¥ —Ä—É—Ç–∞, –≤—ã–ø–æ–ª–Ω—è–µ–º kinit:**
```bash
kinit
P@ssw0rd
```
```bash
admc
```
**–ù–∞—Å—Ç—Ä–æ–∏–º –≥—Ä—É–ø–ø–æ–≤—É—é –ø–æ–ª–∏—Ç–∫—É:**
- Group Policy Objects
- au-team.irpo > –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏
- Create a GPO and link to ths GPU
- –ù–∞–∑–≤–∞–Ω–∏–µ: sudoers
- –°—Ç–∞–≤–∏–º –≥–∞–ª–æ—á–∫—É –≤ –ø–æ–ª–µ enforced
- –ü—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏ –ø–æ sudoers > edit
- Machine
- Administative Templates
- Samba
- Unix Settings
- Sudo rights
- Enabled
- /usr/bin/id
- /bin/cat
- /bin/grep
- –ü—Ä–∏–º–µ–Ω—è–µ–º –∏ –≤—ã—Ö–æ–¥–∏–º –∏–∑ admc.
```bash
gpupdate -f # –ü—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º 2 —Ä–∞–∑–∞ –ø–æ–¥—Ä—è–¥ —á—Ç–æ–±—ã –∫–æ–º–∞–Ω–¥–∞ —Ç–æ—á–Ω–æ –ø—Ä–∏–º–µ–Ω–∏–ª–∞—Å—å, –∏–Ω–æ–≥–¥–∞ –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å 1 —Ä–∞–∑–∞.
```
**–ó–∞—Ö–æ–¥–∏–º –∏–∑ –ø–æ–¥ user5.hq:**
- –ü–∞—Ä–æ–ª—å - P@ssw0rd

```bash
sudo id
P@ssw0rd
sudo cat /root/.bashrc
sudo cat /root/.bashrc | grep root
```
> –ï—Å–ª–∏ –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è, –∑–Ω–∞—á–∏—Ç –≤—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –≤–µ—Ä–Ω–æ.

### BR-SRV
```bash
apt-get update && apt-get install git -y
git clone https://github.com/meowehh/samba-import
cd samba-import/

cat before_script
sed -i -e 's/\r$//' import.sh

chmod +x import.sh 
./import.sh /opt/users.csv
```
> –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–ø—Ç–∞, –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∑–∞—Ö–æ–¥–∏–º –Ω–∞ HQ-CLI –∏ –ø—ã—Ç–∞–µ–º—Å—è –≤–æ–π—Ç–∏ –≤ –æ–¥–Ω—É –∏–∑ —É—á–µ—Ç–æ–∫, —Ñ–ª–∞–≥–∏ —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–µ –Ω—É–∂–Ω–æ.

### HQ-CLI
```
login: wesley.cain 
password: P@ssw0rd1
```
> –ó–∞ –ø—Ä–∏–º–µ—Ä –≤–∑—è—Ç–∞ —ç—Ç–∞ —É—á–µ—Ç–∫–∞ –∏–∑ /opt/users.csv, –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –ª—é–±—É—é –¥—Ä—É–≥—É—é, –µ—Å–ª–∏ –≤–æ–π—Ç–∏ –ø–æ–ª—É—á–∏–ª–æ—Å—å, –∑–Ω–∞—á–∏—Ç –≤—Å–µ –≤—ã–ø–æ–ª–µ–Ω–µ–Ω–æ –≤–µ—Ä–Ω–æ.


## üìã –ó–∞–¥–∞–Ω–∏–µ 2: –°–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.

**–ó–∞–¥–∞–Ω–∏–µ 2**:
- –ü—Ä–∏ –ø–æ–º–æ—â–∏ —Ç—Ä—ë—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∏—Å–∫–æ–≤, —Ä–∞–∑–º–µ—Ä–æ–º 1–ì–± –∫–∞–∂–¥—ã–π, –Ω–∞ HQ-SRV —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–π—Ç–µ –¥–∏—Å–∫–æ–≤—ã–π –º–∞—Å—Å–∏–≤ —É—Ä–æ–≤–Ω—è 0
- –ò–º—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ ‚Äì md0, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–∞ —Ä–∞–∑–º–µ—â–∞–µ—Ç—Å—è –≤ —Ñ–∞–π–ª–µ /etc/mdadm.conf
- –û–±–µ—Å–ø–µ—á—å—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–∞–ø–∫—É /raid0
- –°–æ–∑–¥–∞–π—Ç–µ —Ä–∞–∑–¥–µ–ª, –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–π—Ç–µ —Ä–∞–∑–¥–µ–ª, –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ext4
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–µ—Ä–≤–µ—Ä —Å–µ—Ç–µ–≤–æ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã(nfs), –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞–ø–∫–∏ –æ–±—â–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –≤—ã–±–µ—Ä–∏—Ç–µ /raid0/nfs, –¥–æ—Å—Ç—É–ø –¥–ª—è —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏ –¥–ª—è –≤—Å–µ–π —Å–µ—Ç–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—É HQ-CLI 
- –ù–∞ HQ-CLI –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–∞–ø–∫—É /mnt/nfs
- –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–µ—Ä–≤–µ—Ä–∞ –æ—Ç–º–µ—Ç—å—Ç–µ –≤ –æ—Ç—á—ë—Ç–µ.

> –ì–æ—Ç–æ–≤—ã–π –æ—Ç—á–µ—Ç –º–æ–∂–Ω–æ –≤–∑—è—Ç—å - [—Ç—É—Ç.](./report_2025.docx)

### HQ-SRV
```bash
lsblk
mdadm -C /dev/md0 -l 0 -n 3 /dev/sd{b,c,d}
lsblk
mkfs.ext4 /dev/md0
echo DEVICE partitions >> /etc/mdadm.conf
mdadm --detail --scan >> /etc/mdadm.conf
mkdir /raid0
```
```bash
mcedit /etc/fstab
/dev/md0	/raid0 ext4 defaults	0	0
```
```bash
mount -a
df -h
lsblk
```
```bash
apt-get update && apt-get install -y nfs-{server,utils}
mkdir /raid0/nfs
chmod 766 /raid0/nfs
```
–ö–æ–º–º–µ–Ω—Ç–∏—Ä—É–µ–º –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É –≤ —Ñ–∞–π–ª–µ /etc/exports, –≤ —Å–∞–º–æ–º –Ω–∏–∑—É –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º, —Ç–æ —á—Ç–æ –∏–¥–µ—Ç –Ω–∏–∂–µ.
```
mcedit /etc/exports
/raid0/nfs 192.168.2.0/28(rw,no_subtree_check,no_root_squash)
```
**–ü—Ä–∏–º–µ–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è**:
```bash
exportfs -arv
systemctl enable --now nfs-server.service
systemctl restart nfs-server.service
```
### HQ-CLI
```bash
apt-get update && apt-get install -y nfs-{server,utils}
mkdir /mnt/nfs
chmod 777 /mnt/nfs
```
```bash
mcedit /etc/fstab
192.168.1.10:/raid0/nfs	/mnt/nfs	nfs	defaults	0	0
systemctl enable --now nfs-server.service
systemctl restart nfs-server.service
```
**–ú–æ–Ω—Ç–∏—Ä—É–µ–º —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –∏ –¥–µ–ª–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É RAID 0**:
```bash
mount -a
df -h
```
**–í—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥—ã:**
```bash
Filesystem               Size  Used Avail Use% Mounted on
udevfs                   5.0M   64K  5.0M   2% /dev
runfs                    3.9G  1.1M  3.9G   1% /run
/dev/sda                  12G  9.1G  2.1G  82% /
tmpfs                    3.9G     0  3.9G   0% /dev/shm
tmpfs                    3.9G  4.0K  3.9G   1% /tmp
tmpfs                    796M   84K  796M   1% /run/user/60601109
tmpfs                    796M   56K  796M   1% /run/user/0
192.168.1.10:/raid0/nfs  2.9G     0  2.8G   0% /mnt/nfs
```
> ‚ö†Ô∏è üí° **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ü—Ä–æ–±—É–µ–º –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É –æ–±–æ–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–≤–æ–¥ —á–µ—Ä–µ–∑ df -h —Å–Ω–æ–≤–∞, —Ä–∞—Å—à–∞—Ä–µ–Ω–Ω–∞—è —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å RAID 0 - –¥–æ–ª–∂–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ–π.

## üìã –ó–∞–¥–∞–Ω–∏–µ 9: –£–¥–æ–±–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ø–Ω–¥–µ–∫—Å –ë—Ä–∞—É–∑–µ—Ä –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π –Ω–∞ HQ-CLI.

**–ó–∞–¥–∞–Ω–∏–µ 2**:
- –£—Å—Ç–∞–Ω–æ–≤–∫—É –±—Ä–∞—É–∑–µ—Ä–∞ –æ—Ç–º–µ—Ç—å—Ç–µ –≤ –æ—Ç—á—ë—Ç–µ.

> –ì–æ—Ç–æ–≤—ã–π –æ—Ç—á–µ—Ç –º–æ–∂–Ω–æ –≤–∑—è—Ç—å - [—Ç—É—Ç.](./report_2025.docx)

**–°–∞–º—ã–π –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–±: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ –ø–∞–∫–µ—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä.**
```bash
apt-get update && apt-get install yandex-browser -y
```
> ‚ö†Ô∏è üí° **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ–Ω –Ω–µ –ø–æ—è–≤–∏—Ç—Å—è –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ, –∞ —Ç–æ–ª—å–∫–æ –≤ –ø–∞–Ω–µ–ª–∏ –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞, –ø–æ—Å–ª–µ —Ä–µ–±—É—Ç–∞ –ø–æ—è–≤–∏—Ç—Å—è –∏ –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ, –Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ –¥–æ –∑–∞–¥–∞–Ω–∏—è —Å —Ä–∞–∑–≤–µ—Ä—Ç–∫–æ–π Docker, —Ç–∞–∫ –∫–∞–∫ —Ç–∞–º –æ–Ω –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è —á—Ç–æ–±—ã –æ–±–æ–π—Ç–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É hub.docker —á–µ—Ä–µ–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø—Ä–æ–∫—Å–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ, –ª–∏—à–Ω–∏–π —Ä–∞–∑ –µ–≥–æ –ª—É—á—à–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–∞–∫ –∫–∞–∫ –Ω–∞ HQ-CLI –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—Å–µ–≥–æ 1.5–ì–ë –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é 1 –ì–ë, —ç—Ç–æ –º–æ–∂–µ—Ç –ø–æ–ª–æ–∂–∏—Ç—å HQ-CLI.

## üìã –ó–∞–¥–∞–Ω–∏–µ 3: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–ª—É–∂–±—É —Å–µ—Ç–µ–≤–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –±–∞–∑–µ —Å–µ—Ä–≤–∏—Å–∞ chrony

**–ó–∞–¥–∞–Ω–∏–µ 3**:
- –í –∫–∞—á–µ—Å—Ç–≤–µ —Å–µ—Ä–≤–µ—Ä–∞ –≤—ã—Å—Ç—É–ø–∞–µ—Ç HQ-RTR
- –ù–∞ HQ-RTR –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–µ—Ä–≤–µ—Ä chrony, –≤—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞—Ç—É–º 5
- –í –∫–∞—á–µ—Å—Ç–≤–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ HQ-SRV, HQ-CLI, BR-RTR, BR-SRV

### HQ-RTR

```bash
apt-get update && apt-get install -y chrony
```
```bash
vim /etc/chrony.conf
pool ntp0.ntp-servers.net iburst prefer
pool 127.0.0.1 iburst 
hwtimestamp *
local stratum 5
allow 0/0
```
**–ó–∞–ø—É—Å—Ç–∏–º —Å–ª—É–∂–±—É –≤—Ä–µ–º–µ–Ω–∏:**
```bash
systemctl restart chronyd
systemctl enable --now chronyd
timedatectl set-timezone Asia/Novosibirsk
```
–í –∫–∞—á–µ—Å—Ç–≤–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞—Å—Ç—Ä–æ–∏–º: HQ-SRV, HQ-CLI, BR-RTR, BR-SRV, –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É –Ω—É–∂–Ω–æ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ –Ω–∏–∂–Ω–µ–π –Ω–∞ –≤—Å–µ—Ö 4-–µ—Ö –∫–ª–∏–µ–Ω—Ç–∞—Ö.
```bash
apt-get update && apt-get install -y chrony
vim /etc/chrony.conf
pool 192.168.1.1 iburst prefer
systemctl restart chronyd
systemctl enable --now chronyd
timedatectl set-timezone Asia/Novosibirsk
```
> ‚ö†Ô∏è üí° **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ù–∞ HQ-CLI —É–∂–µ –±—É–¥–µ—Ç —Å–µ—Ä–≤–µ—Ä –≤—Ä–µ–º–µ–Ω–∏, –Ω—É–∂–Ω–æ –ª–∏—à—å –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π pool.

**–ü—Ä–æ–≤–µ–¥–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞—Å—Ç—Ä–æ–µ–∫, –≤ –æ—Ç–≤–µ—Ç–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä –≤—Ä–µ–º–µ–Ω–∏ —Å stratum 5, –Ω–∞ HQ-CLI –±—É–¥–µ—Ç 2 —Å–µ—Ä–≤–µ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏, —Å stratum 0 (–Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–π) –∏ —Å stratum 5 (–∞–∫—Ç–∏–≤–Ω—ã–π).**
```bash
chronyc sources
```
### HQ-RTR
```bash
chronyc clients
```
```bash
Hostname                      NTP   Drop Int IntL Last     Cmd   Drop Int  Last
===============================================================================
localhost.localdomain          13      0   7   -    35       0      0   -     -
hq-srv.au-team.irpo             8      0   6   -    17       0      0   -     -
hq-cli.au-team.irpo             6      0   5   -    39       0      0   -     -
192.168.5.2                     5      0   4   -    10       0      0   -     -
192.168.3.10                    4      0   1   -    16       0      0   -     -
```
> ‚ö†Ô∏è üí° **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –í –æ—Ç–≤–µ—Ç–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—Å–µ –∫–ª–∏–µ–Ω—Ç—ã, —É –Ω–∏—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ —Ç–æ—Ç IP —á—Ç–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –≥–ª–∞–≤–Ω–æ–µ —á—Ç–æ–±—ã –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–≤–ø–∞–¥–∞–ª–æ —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏, –∞ —Ç–∞–∫ –∂–µ –Ω–∞ —Å–∞–º–∏—Ö –∫–ª–∏–µ–Ω—Ç–∞—Ö —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É chronyc sources, - –±—ã–ª —É–∫–∞–∑–∞–Ω stratum 5.

## üìã –ó–∞–¥–∞–Ω–∏–µ 4:  –°–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–π—Ç–µ ansible –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ BR-SRV

**–ó–∞–¥–∞–Ω–∏–µ 4**:
- –°—Ñ–æ—Ä–º–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è, –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å –¥–æ–ª–∂–Ω—ã –≤—Ö–æ–¥–∏—Ç—å HQ-SRV, HQ-CLI, HQ-RTR –∏ BR-RTR
- –†–∞–±–æ—á–∏–π –∫–∞—Ç–∞–ª–æ–≥ ansible –¥–æ–ª–∂–µ–Ω —Ä–∞—Å–ø–æ–ª–∞–≥–∞—Ç—å—Å—è –≤ /etc/ansible
- –í—Å–µ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –º–∞—à–∏–Ω—ã –¥–æ–ª–∂–Ω—ã –±–µ–∑ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –∏ –æ—à–∏–±–æ–∫ –æ—Ç–≤–µ—á–∞—Ç—å pong –Ω–∞ –∫–æ–º–∞–Ω–¥—É ping –≤ ansible –ø–æ—Å–ª–∞–Ω–Ω—É—é —Å BR-SRV

### BR-SRV
```bash
apt-get update && apt-get install openssh-server ansible sshpass nano -y
```
```bash
nano /etc/ansible/hosts
[Alt]
192.168.2.1 ansible_ssh_user=net_admin ansible_ssh_pass=P@ssw0rd
192.168.1.10 ansible_ssh_user=sshuser ansible_ssh_pass=P@ssw0rd
192.168.2.10 ansible_ssh_user=sysadmin ansible_ssh_pass=P@ssw0rd
192.168.3.1 ansible_ssh_user=net_admin ansible_ssh_pass=P@ssw0rd

[Alt:vars]
ansible_port=2024
```
```bash
nano /etc/ansible/ansible.cfg
[defaults]

interpreter_python = /usr/bin/python3

# some basic default values...
# uncomment this to disable SSH key host checking
host_key_checking = False
```

### HQ-SRV
```bash
apt-get update && apt-get install openssh-server -y
```
```bash
vim /etc/openssh/sshd_config
Port 2024
MaxAuthTries 2
AllowUsers sshuser
```
```bash
systemctl enable --now sshd
systemctl restart sshd
```

### HQ-RTR –∏ BR-RTR
```bash
apt-get update && apt-get install openssh-server -y
```
```bash
vim /etc/openssh/sshd_config
Port 2024
MaxAuthTries 2
AllowUsers net_admin
```
```bash
systemctl enable --now sshd
systemctl restart sshd
```

### HQ-CLI 
```bash
apt-get update && apt-get install openssh-server -y
```
```bash
useradd sysadmin
passwd sysadmin
P@ssw0rd
usermod -a -G remote sysadmin
```
```bash
vim /etc/openssh/sshd_config
Port 2024
MaxAuthTries 2
AllowGroups wheel remote
```
```bash
systemctl enable --now sshd
systemctl restart sshd
```

### BR-SRV
```bash
ansible -m ping all
```
**–í—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥—ã**:
```bash
192.168.3.1 | SUCCESS => {
    "changed": false,
    "ping": "pong"
}
192.168.2.1 | SUCCESS => {
    "changed": false,
    "ping": "pong"
}
192.168.1.10 | SUCCESS => {
    "changed": false,
    "ping": "pong"
}
192.168.2.10 | SUCCESS => {
    "changed": false,
    "ping": "pong"
}
```
> ‚ö†Ô∏è üí° **–í–∞–∂–Ω–æ**: –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ–±—ã –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥—ã —Å–æ–≤–ø–∞–¥–∞–ª, –µ—Å–ª–∏ –≤—Å–µ —Å–æ–≤–ø–¥–∞–µ—Ç, –∑–Ω–∞—á–∏—Ç –∑–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –≤–µ—Ä–Ω–æ.


## üìã –ó–∞–¥–∞–Ω–∏–µ 5:  –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤ Docker –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ BR-SRV.

**–ó–∞–¥–∞–Ω–∏–µ 5**: 

- –°–æ–∑–¥–∞–π—Ç–µ –≤ –¥–æ–º–∞—à–Ω–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ñ–∞–π–ª wiki.yml –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è MediaWiki.
- –°—Ä–µ–¥—Å—Ç–≤–∞–º–∏ docker compose –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è —Å—Ç–µ–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º MediaWiki –∏ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–≤–∞ —Å–µ—Ä–≤–∏—Å–∞
- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä MediaWiki –¥–æ–ª–∂–µ–Ω –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è wiki –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–∑ mediawiki
- –§–∞–π–ª LocalSettings.php —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –¥–æ–º–∞—à–Ω–µ–π –ø–∞–ø–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –æ–±—Ä–∞–∑.
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –¥–æ–ª–∂–µ–Ω –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è mariadb –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–∑ mariadb.
- –†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ 
- –û–Ω –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞–≤–∞—Ç—å –±–∞–∑—É —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º mediawiki, –¥–æ—Å—Ç—É–ø–Ω—É—é –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É –ø–æ—Ä—Ç—É, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è wiki —Å –ø–∞—Ä–æ–ª–µ–º WikiP@ssw0rd –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö 
- MediaWiki –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∞ –∏–∑–≤–Ω–µ —á–µ—Ä–µ–∑ –ø–æ—Ä—Ç 8086.

### BR-SRV
```bash
apt-get update && apt-get install openssh-server docker-ce docker-compose -y
```
**–ù–∞—Å—Ç—Ä–æ–∏–º –∏ –∑–∞–ø—É—Å—Ç–∏–º SSH, - —á—Ç–æ–±—ã –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –ø–µ—Ä–µ–±—Ä–æ—Å–∏—Ç—å —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥–∞ mediawiki —Å HQ-CLI –Ω–∞ BR-SRV**:
```bash
vim /etc/openssh/sshd_config
Port 2024
MaxAuthTries 2
AllowUsers sshuser
```
```bash
systemctl enable --now sshd
systemctl restart sshd
```
### HQ-CLI

- –ó–∞–ø—É—Å–∫–∞–µ–º –Ø–Ω–¥–µ–∫—Å –±—Ä–∞—É–∑–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ [—Ä–∞–Ω–µ–µ](https://github.com/meowehh/DemoExam_2025/blob/main/Module_2.md#-%D0%B7%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-9-%D1%83%D0%B4%D0%BE%D0%B1%D0%BD%D1%8B%D0%BC-%D1%81%D0%BF%D0%BE%D1%81%D0%BE%D0%B1%D0%BE%D0%BC-%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%B8%D1%82%D0%B5-%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5-%D1%8F%D0%BD%D0%B4%D0%B5%D0%BA%D1%81-%D0%B1%D1%80%D0%B0%D1%83%D0%B7%D0%B5%D1%80-%D0%B4%D0%BB%D1%8F-%D0%BE%D1%80%D0%B3%D0%B0%D0%BD%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B9-%D0%BD%D0%B0-hq-cli). –ß–µ—Ä–µ–∑ Firefox –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.
- –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —Å–∞–π—Ç hub.docker.com
- –í –ø–æ–∏—Å–∫–µ –≤–±–∏–≤–∞–µ–º mediawiki
- –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å mediawiki –ª–∏—Å—Ç–∞–µ–º –≤–Ω–∏–∑ –∏ –Ω–∞—Ö–æ–¥–∏–º –∫–æ–Ω—Ñ–∏–≥ compose.yaml
- –ö–æ–ø–∏—Ä—É–µ–º –∫–æ–Ω—Ñ–∏–≥
- –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª
```bash
su -
toor
ssh sshuser@192.168.3.10 -p 2024 # –ó–∞—Ö–æ–¥–∏–º –Ω–∞ BR-SRV
P@ssw0rd
su -
toor
mcedit wiki.yml
```
**–í—Å—Ç–∞–≤–ª—è–µ–º —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥, —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –Ø–Ω–¥–µ–∫—Å –±—Ä–∞—É–∑–µ—Ä.**

–î–∞–ª–µ–µ –ø—Ä–∏–≤–æ–¥–∏–º —Ñ–∞–π–ª wiki.yml –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–∏–¥—É:
```bash
# MediaWiki with MariaDB
#
# Access via "http://localhost:8080"
services:
  wiki:
    image: mediawiki
    restart: always
    ports:
      - 8086:80
    links:
      - mariadb
    volumes:
      - images:/var/www/html/images
      # After initial setup, download LocalSettings.php to the same directory as
      # this yaml and uncomment the following line and use compose to restart
      # the mediawiki service
      # - ./LocalSettings.php:/var/www/html/LocalSettings.php
  mariadb: # <- This key defines the name of the database during setup
    image: mariadb
    restart: always
    environment:
      # @see https://phabricator.wikimedia.org/source/mediawiki/browse/master/includes
      MYSQL_DATABASE: mediawiki
      MYSQL_USER: wiki
      MYSQL_PASSWORD: WikiP@ssw0rd
      MYSQL_RANDOM_ROOT_PASSWORD: 'yes'
    volumes:
      - db:/var/lib/mysql

volumes:
  images:
  db:
```
**–ó–∞–ø—É—Å–∫–∞–µ–º docker –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ–º mediawiki**:
```bash
systemctl enable --now docker.service docker.socket
docker compose -f wiki.yml up -d
```
> –î–æ–∂–∏–¥–∞–µ–º—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è.

- –û—Ç–∫—Ä—ã–≤–∞–µ–º Firefox, –ø–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ 192.168.3.10:8086
- set up the wiki
- 2 —Ä–∞–∑–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.
- Database type - mariadb
- Database host - mariadb
- Database name - mediawiki
- Databse username - wiki
- Databse password - WikiP@ssw0rd
- Use the same account as for installation
- URL host name - wiki
- Project namespace - as the wiki name: wiki
- Administation account:
- User: wiki
- Password: WikiP@ssw0rd
- Do NOT share data about this installation
- I'm bored already, just install the wiki
- –ñ–º–µ–º –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –¥–æ —Ç–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞ –∫–∞–∫ –Ω–µ —Å–∫–∞—á–∞–µ—Ç—Å—è LocalSettings.php

**–ó–∞–ø—É—Å–∫–∞–µ–º –µ—â—ë –æ–¥–∏–Ω —Ç–µ—Ä–º–∏–Ω–∞–ª:**
```bash
cd Downloads/
scp -P 2024 LocalSettings.php sshuser@192.168.3.10:/home/sshuser
yes
P@ssw0rd
```
**–û—Ç–∫—Ä—ã–≤–∞–µ–º –ø—Ä–æ—à–ª—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª –≥–¥–µ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ SSH —Å BR-SRV:**
```bash
cd /home/sshuser
cp LocalSettings.php ~
cd ~
```
```bash
docker compose -f wiki.yml down
```
**–£–±–∏—Ä–∞–µ–º –∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ç–æ–π —Å—Ç—Ä–æ–∫–∏:**
```bash
mcedit wiki.yml
- ./LocalSettings.php:/var/www/html/LocalSettings.php
```
**–ò—â–µ–º —É–∫–∞–∑–∞–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É –∏ –º–µ–Ω—è–µ–º –µ–µ –Ω–∞ –¥–∞–Ω–Ω—É—é:**
```bash
mcedit LocalSettings.php
$wgServer = "http://192.168.3.10:8086";
```
```bash
docker compose -f wiki.yml up -d
```
> –°–∞–π—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è –ø–æ 192.168.3.10:8086, –µ—Å–ª–∏ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–Ω–∞—á–∏—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤–µ—Ä–Ω–æ, –ø—Ä–æ–±—É–µ–º –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: wiki, —Å –ø–∞—Ä–æ–ª–µ–º WikiP@ssw0rd. –ï—Å–ª–∏ –ø–æ–ª—É—á–∏–ª–æ—Å—å, –∑–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –≤–µ—Ä–Ω–æ.

## üìã –ó–∞–¥–∞–Ω–∏–µ 6: –ù–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞—Ö —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–π—Ç–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫—É—é —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—é –ø–æ—Ä—Ç–æ–≤.

**–ó–∞–¥–∞–Ω–∏–µ 6**: 
- –ü—Ä–æ–±—Ä–æ—Å—å—Ç–µ –ø–æ—Ä—Ç 80 –≤ –ø–æ—Ä—Ç 8086 –Ω–∞ BR-SRV –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–µ BR-RTR, –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–∞ wiki
- –ü—Ä–æ–±—Ä–æ—Å—å—Ç–µ –ø–æ—Ä—Ç 80 –≤ –ø–æ—Ä—Ç 80 –Ω–∞ HQ-SRV –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–µ HQ-RTR, –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–∞ moodle
- –ü—Ä–æ–±—Ä–æ—Å—å—Ç–µ –ø–æ—Ä—Ç 3015 –≤ –ø–æ—Ä—Ç 3015 –Ω–∞ HQ-SRV –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–µ HQ-RTR
- –ü—Ä–æ–±—Ä–æ—Å—å—Ç–µ –ø–æ—Ä—Ç 3015 –≤ –ø–æ—Ä—Ç 3015 –Ω–∞ BR-SRV –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–µ BR-RTR

### BR-RTR
```bash
apt-get update && apt-get install iptables -y
```
```bash
iptables -t nat -A PREROUTING -p tcp --dport 80 -j DNAT --to-destination 192.168.3.10:8086
iptables -A FORWARD -p tcp -d 192.168.3.10 --dport 8086 -m state --state NEW,ESTABLISHED,RELATED -j ACCEPT

iptables -t nat -A PREROUTING -p tcp --dport 3015 -j DNAT --to-destination 192.168.3.10:3015
iptables -A FORWARD -p tcp -d 192.168.3.10 --dport 3015 -m state --state NEW,ESTABLISHED,RELATED -j ACCEPT
```
```bash
iptables-save > /etc/sysconfig/iptables
systemctl restart iptables
systemctl enable --now iptables
```
**–í—ã–ø–æ–ª–Ω–∏–º –ø—Ä–æ–≤–µ—Ä–∫—É**:
```bash
iptables -t nat -L -n -v
```
**–ü–æ–ª—É—á–∞–µ–º –≤—ã–≤–æ–¥**:
```bash
Chain PREROUTING (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 DNAT       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:80 to:192.168.3.10:8086
    0     0 DNAT       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:3015 to:192.168.3.10:3015

Chain INPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain POSTROUTING (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination 
```
**–ü–æ–≤—Ç–æ—Ä–∏–º –ø—Ä–æ–≤–µ—Ä–∫—É**:
```bash
iptables -L -n -v
```
**–°–≤–µ—Ä—è–µ–º –≤—ã–≤–æ–¥ —Å –º–æ–∏–º**:
```bash
Chain INPUT (policy ACCEPT 4 packets, 320 bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0            192.168.3.10         tcp dpt:8086 state NEW,RELATED,ESTABLISHED
    0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0            192.168.3.10         tcp dpt:3015 state NEW,RELATED,ESTABLISHED

Chain OUTPUT (policy ACCEPT 6 packets, 480 bytes)
 pkts bytes target     prot opt in     out     source               destination
```

### HQ-RTR
```bash
apt-get update && apt-get install iptables -y
```
```bash
iptables -t nat -A PREROUTING -p tcp --dport 80 -j DNAT --to-destination 192.168.1.10:80
iptables -A FORWARD -p tcp -d 192.168.1.10 --dport 80 -m state --state NEW,ESTABLISHED,RELATED -j ACCEPT

iptables -t nat -A PREROUTING -p tcp --dport 3015 -j DNAT --to-destination 192.168.1.10:3015
iptables -A FORWARD -p tcp -d 192.168.1.10 --dport 3015 -m state --state NEW,ESTABLISHED,RELATED -j ACCEPT
```
```bash
iptables-save > /etc/sysconfig/iptables
systemctl restart iptables
systemctl enable --now iptables
```
**–í—ã–ø–æ–ª–Ω–∏–º –ø—Ä–æ–≤–µ—Ä–∫—É**:
```bash
iptables -t nat -L -n -v
```
**–ü–æ–ª—É—á–∞–µ–º –≤—ã–≤–æ–¥**:
```bash
Chain PREROUTING (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 DNAT       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:80 to:192.168.1.10:80
    0     0 DNAT       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:3015 to:192.168.1.10:3015

Chain INPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain POSTROUTING (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination 
```
**–ü–æ–≤—Ç–æ—Ä–∏–º –ø—Ä–æ–≤–µ—Ä–∫—É**:
```bash
iptables -L -n -v
```
**–°–≤–µ—Ä—è–µ–º –≤—ã–≤–æ–¥ —Å –º–æ–∏–º**:
```bash
Chain INPUT (policy ACCEPT 8 packets, 624 bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain FORWARD (policy ACCEPT 6 packets, 456 bytes)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0            192.168.1.10         tcp dpt:80 state NEW,RELATED,ESTABLISHED
    0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0            192.168.1.10         tcp dpt:3015 state NEW,RELATED,ESTABLISHED

Chain OUTPUT (policy ACCEPT 6 packets, 464 bytes)
 pkts bytes target     prot opt in     out     source               destination 
```
> –ï—Å–ª–∏ –≤—ã–≤–æ–¥ —Å–æ–≤–ø–∞–¥–∞–µ—Ç, –∑–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –≤–µ—Ä–Ω–æ.

## üìã –ó–∞–¥–∞–Ω–∏–µ 7: –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å moodle –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ HQ-SRV:

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä apache
- –í –∫–∞—á–µ—Å—Ç–≤–µ —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ mariadb
- –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö moodledb
- –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è moodle —Å –ø–∞—Ä–æ–ª–µ–º P@ssw0rd –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –µ–º—É –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è admin –≤ —Å–∏—Å—Ç–µ–º–µ –æ–±—É—á–µ–Ω–∏—è –∑–∞–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å P@ssw0rd
- –ù–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –¥–æ–ª–∂–µ–Ω –æ—Ç—Ä–∞–∂–∞—Ç—å—Å—è –Ω–æ–º–µ—Ä —Ä–∞–±–æ—á–µ–≥–æ –º–µ—Å—Ç–∞ –≤ –≤–∏–¥–µ –∞—Ä–∞–±—Å–∫–æ–π —Ü–∏—Ñ—Ä—ã, –¥—Ä—É–≥–∏—Ö –ø–æ–¥–ø–∏—Å–µ–π –¥–µ–ª–∞—Ç—å –Ω–µ –Ω–∞–¥–æ
- –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ç–º–µ—Ç—å—Ç–µ –≤ [–æ—Ç—á—ë—Ç–µ](./report_2025.docx)

### HQ-SRV
```bash
apt-get update && apt-get install deploy -y
```
```bash
mcedit /usr/share/deploy/moodle/tasks/main.yml
```
**–ñ–º–µ–º F4, –≤—Ö–æ–¥–∏–º –≤ —Ä–µ–∂–∏–º Replace.**
- –ó–∞–º–µ–Ω—è–µ–º –≤—Å–µ moodle1 –Ω–∞ moodledb, - 4 –∑–∞–º–µ–Ω—ã.
- –ò —Ç–∞–∫ –∂–µ –∑–∞–º–µ–Ω—è–µ–º –≤—Å–µ moodleuser –Ω–∞ moodle, - 2 –∑–∞–º–µ–Ω—ã.
  
**–ò—â–µ–º —Å—Ç—Ä–æ–∫—É:**
```bash
shell: pwgen 16 1
```
**–ó–∞–º–µ–Ω—è–µ–º –Ω–∞:**
```bash
shell: echo "P@ssw0rd"
```
> –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∑–∞–ø—É—Å–∫–∞–µ–º —Ä–∞–∑–≤–µ—Ä—Ç–∫—É moodle.
```bash
deploy moodle
```
> –î–æ–∂–∏–¥–∞–µ–º—Å—è –ø–æ–ª–Ω–æ–π —Ä–∞–∑–≤–µ—Ä—Ç–∫–∏, —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ö–æ—Ä–æ—à–∞—è –∏ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏, –∑–∞–Ω–∏–º–∞–µ—Ç –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.

**–ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤—ã–≤–æ–¥, –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:**
```bash
Deploying moodle...
Executing playbook moodle.yml

- deploy Moodle on hosts: local -
install Apache packages...
  localhost done
  localhost done
  localhost done
  localhost done
check certificate file...
  localhost ok
generate certificate file...
  localhost done
enable Apache2 module filter...
  localhost done
enable Apache2 module ssl...
  localhost done
enable Apache2 module rewrite...
  localhost done
enable Apache2 module headers...
  localhost done
enable Apache2 module env...
  localhost done
enable Apache2 module dir...
  localhost ok
enable Apache2 module mime...
  localhost ok
enable Apache2 module mod_php8.2...
  localhost ok
disable Apache2 module mod_php7...
  localhost ok
enable HTTPS (default_https)...
  localhost done
enable HTTPS (https)...
  localhost done
configure port 80...
  localhost done | msg: line added
configure port 443...
  localhost done | msg: line added
change example server name...
  localhost done | msg: 1 replacements made
change _default_ placeholder for https...
  localhost done | msg: 1 replacements made
set port 80 for default server...
  localhost done | msg: line replaced
add RewriteEngine On...
  localhost done | msg: line added
add RewriteCond...
  localhost done | msg: line added
add RewriteRule...
  localhost done | msg: line added
detect PHP settings...
  localhost ok
configure PHP memory_limit setting...
  localhost done
configure PHP upload_max_filesize setting...
  localhost done
configure PHP max_input_vars setting...
  localhost done
reload Apache2 configuration...
[WARNING]: Consider using the service module rather than running 'service'.  If you need to use command because service is insufficient you can add 'warn: false' to this command task or set
'command_warnings=False' in ansible.cfg to get rid of this message.
  localhost ok
start Apache service...
  localhost done
detect HTTP DocumentRoot...
  localhost ok | stdout: DocumentRoot for http: "/var/www/html"
detect HTTPS DocumentRoot...
  localhost ok | stdout: DocumentRoot for https: "/var/www/html"
install MariaDB server packages...
  localhost done | item: mariadb-server | msg: mariadb-server present(s)
  localhost done
start MariaDB service...
  localhost done
install Moodle packages...
  localhost done | item: moodle | msg: moodle present(s)
  localhost done | item: moodle-apache2 | msg: moodle-apache2 present(s)
  localhost ok | msg: Nothing to install
  localhost done | item: moodle-local-mysql | msg: moodle-local-mysql present(s)
  localhost done | item: python3-module-pymysql | msg: python3-module-pymysql present(s)
  localhost done | item: pwgen | msg: pwgen present(s)
  localhost ok | msg: Nothing to install
  localhost done
check if database moodledb exists...
  localhost done
generate password for Moodle...
  localhost ok
create database user...
  localhost done
check for config file...
  localhost ok
generate configuration by install script from moodle...
  localhost done
reload Apache2 configuration...
  localhost ok
one try to open web page...
  localhost ok
Change password to Moodle for user admin...

- Play recap -
  localhost                  : ok=40   changed=27   unreachable=0    failed=0    rescued=0    ignored=0   
Deploy complete successful.
```
> **‚ö†Ô∏è üí° –í–∞–∂–Ω–æ!** –¢–µ–ø–µ—Ä—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ª–∏ —Å–æ–∑–¥–∞–ª–∏—Å—å –≤—Å–µ –Ω—É–∂–Ω—ã–µ –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º config —Ñ–∞–π–ª—ã, –∏–Ω–æ–≥–¥–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –±–∞–≥ –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã–ª–∏ —Å–æ–∑–¥–∞—Ç—å—Å—è, –Ω–æ –Ω–µ —Å–æ–∑–¥–∞–ª–∏—Å—å.

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥–æ–≤:**

```bash
vim /var/www/webapps/moodle/config.php 
```
> –û—Ç–∫—Ä—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å –∏ –≤ –Ω–µ–º –µ—Å—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ, —Ç–æ –∑–Ω–∞—á–∏—Ç –≤—Å–µ —Ö–æ—Ä–æ—à–æ, –µ—Å–ª–∏ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ –Ω–µ—Ç –∏–ª–∏ –æ–Ω –ø—É—Å—Ç–æ–π, —Ç–æ –∑–∞–ø—É—Å–∫–∞–µ–º –∫–æ–º–∞–Ω–¥—É deploy moodle –µ—â—ë —Ä–∞–∑, –ø–æ—Å–ª–µ 2 —Ä–∞–∑–∞ config.php –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤—Å–µ–≥–¥–∞.

–ü—Ä–∏–≤–æ–¥–∏–º —Ñ–∞–π–ª config.php –∫ —Å–ª–µ–¥—É—é—â–µ–º –≤–∏–¥—É:
```bash
vim /var/www/webapps/moodle/config.php
$CFG->wwwroot   = 'http://hq-srv.au-team.irpo/moodle';# –û–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —ç—Ç—É —Å—Ç—Ä–æ–∫—É, —É–±–∏—Ä–∞–µ–º –∫–∞–ø—Å –∏ –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ http
```
```bash
mcedit /etc/httpd2/conf/sites-enabled/000-default.conf
# –ö–æ–º–º–µ–Ω—Ç–∏—Ä—É–µ–º 3 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å—Ç—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å Rewrite
```
```bash
systemctl restart httpd2
```

### HQ-CLI

**‚ö†Ô∏è üí° –í–Ω–∏–º–∞–Ω–∏–µ:** –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –Ω–∏–∂–µ –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –¥–æ–º–µ–Ω, –Ω–æ –ø–æ–∑–∂–µ —è –ø–æ–∫–∞–∂—É –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –µ–µ –æ–±—Ä–∞—Ç–Ω–æ, –ø–æ–∫–∞ —á—Ç–æ –¥–µ–ª–∞–µ–º —Ç–∞–∫, –≤–µ—Ä–Ω–µ–º –ø–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏–º nginx.

```bash
nmcli connection modify CLI-NET \
> ipv4.ignore-auto-dns no
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏:**
- –ù–∞–∂–∏–º–∞–µ–º –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏ –≤ –ø–∞–Ω–µ–ª–µ –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ —Å–ø—Ä–∞–≤–∞ —Å–Ω–∏–∑—É –Ω–∞ —Å–µ—Ç—å.
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
- –í—ã–±–∏—Ä–∞–µ–º CLI-NET
- DNS Settings
- Additional DNS servers # –£–¥–∞–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ, –æ—Å—Ç–∞–≤–ª—è–µ–º –ø—É—Å—Ç–æ–µ –ø–æ–ª–µ.
- –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è.
- –ù–∞–∂–∏–º–∞–µ–º –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏ –≤ –ø–∞–Ω–µ–ª–µ –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ —Å–ø—Ä–∞–≤–∞ —Å–Ω–∏–∑—É –Ω–∞ —Å–µ—Ç—å.
- Enable Networking # –í—ã–∫–ª—é—á–∏—Ç—å –∏ –≤–∫–ª—é—á–∏—Ç—å


**–û—Ç–∫—Ä—ã–≤–∞–µ–º Firefox:**
- –ó–∞—Ö–æ–¥–∏–º –Ω–∞ hq-srv.au-team.irpo/moodle
- –õ–æ–≥–∏–Ω: Admin
- –ü–∞—Ä–æ–ª—å: P@ssw0rd
- –ê–≤—Ç–æ—Ä–∏–∑—É–µ–º—Å—è, —É–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—á—Ç—É: moodle@au-team.irpo
- –í –Ω–∞—á–∞–ª–æ
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏
- –ü–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–∞–π—Ç–∞ - 1 (–ò–ª–∏ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ, —ç—Ç–æ –º–µ—Å—Ç–æ —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞ –∏–∑ –∑–∞–¥–∞–Ω–∏—è)

> –ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ.

## üìã –ó–∞–¥–∞–Ω–∏–µ 8: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä nginx –∫–∞–∫ –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä –Ω–∞ ISP.

**–ó–∞–¥–∞–Ω–∏–µ 8**:
- –ü—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –ø–æ –¥–æ–º–µ–Ω–Ω–æ–º—É –∏–º–µ–Ω–∏ moodle.au-team.irpo —É –∫–ª–∏–µ–Ω—Ç–∞ –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è —Å–µ—Ä–≤–∏—Å moodle
- –ü—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –ø–æ –¥–æ–º–µ–Ω–Ω–æ–º—É –∏–º–µ–Ω–∏ wiki.au-team.irpo –∫–ª–∏–µ–Ω—Ç–∞ –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è —Å–µ—Ä–≤–∏—Å mediwiki

### ISP
```bash
apt-get update && apt-get install nginx nano -y
```
```bash
cp /etc/nginx/sites-available.d/default.conf /etc/nginx/sites-available.d/moodle.conf
```
```bash
nano /etc/nginx/sites-available.d/moodle.conf
upstream moodle.au-team.irpo {
        server 172.16.4.4;
}
server {
        listen  80;
        server_name _;

        location / {
                # root /var/www/html;

                # autoindex off;
                # autoindex_exact_size on;
                # autoindex_localtime off;

                # expires off;

                # cooperate with mod_realip in apache-1.3 or mod_rpaf in apache-2.x
                #       proxy_redirect off;
                #       proxy_set_header Host $host;
                #       proxy_set_header X-Real-IP $remote_addr;
                #       proxy_set_header X-Forwarded-For $remote_addr;
                        proxy_pass http://moodle.au-team.irpo/moodle;
                #
                # NB: it's better for URI canonicalization that apache sits on :80
                # (even if that's only 127.0.0.1:80)
                #
                # see also set_real_ip_from, real_ip_header if this nginx
                # would need to cooperate with another one acting as a frontend
        }

#               charset         on;
#               source_charset  koi8-r;

#               access_log  /var/log/nginx/access.log;
}
```
```bash
cp /etc/nginx/sites-available.d/moodle.conf /etc/nginx/sites-available.d/wiki.conf
```
```bash
nano /etc/nginx/sites-available.d/wiki.conf
upstream wiki.au-team.irpo {
        server 172.16.5.5:80;
}
server {
        listen  8086;
        server_name _;

        location / {
                # root /var/www/html;

                # autoindex off;
                # autoindex_exact_size on;
                # autoindex_localtime off;

                # expires off;

                # cooperate with mod_realip in apache-1.3 or mod_rpaf in apache-2.x
                #       proxy_redirect off;
                #       proxy_set_header Host $host;
                #       proxy_set_header X-Real-IP $remote_addr;
                #       proxy_set_header X-Forwarded-For $remote_addr;
                        proxy_pass http://wiki.au-team.irpo;
                #
                # NB: it's better for URI canonicalization that apache sits on :80
                # (even if that's only 127.0.0.1:80)
                #
                # see also set_real_ip_from, real_ip_header if this nginx
                # would need to cooperate with another one acting as a frontend
        }

#               charset         on;
#               source_charset  koi8-r;

#               access_log  /var/log/nginx/access.log;
}
```
```bash
ln -s /etc/nginx/sites-available.d/moodle.conf /etc/nginx/sites-enabled.d/moodle.conf
ln -s /etc/nginx/sites-available.d/wiki.conf /etc/nginx/sites-enabled.d/wiki.conf
```
```bash
systemctl restart nginx
systemctl reload nginx
systemctl enable --now nginx
```
```bash
systemctl status nginx
```
```bash
‚óè nginx.service - The nginx HTTP and reverse proxy server
     Loaded: loaded (/usr/lib/systemd/system/nginx.service; enabled; preset: disabled)
     Active: active (running) since Mon 2025-12-08 00:35:22 UTC; 1min 14s ago
   Main PID: 5749 (nginx)
      Tasks: 11 (limit: 1142)
     Memory: 9.1M (peak: 18.8M)
        CPU: 50ms
     CGroup: /system.slice/nginx.service
             ‚îú‚îÄ5749 "nginx: master process /usr/sbin/nginx -g daemon off;"
             ‚îú‚îÄ5768 "nginx: worker process"
             ‚îú‚îÄ5770 "nginx: worker process"
             ‚îú‚îÄ5771 "nginx: worker process"
             ‚îú‚îÄ5772 "nginx: worker process"
             ‚îú‚îÄ5773 "nginx: worker process"
             ‚îú‚îÄ5774 "nginx: worker process"
             ‚îú‚îÄ5775 "nginx: worker process"
             ‚îú‚îÄ5776 "nginx: worker process"
             ‚îú‚îÄ5777 "nginx: worker process"
             ‚îî‚îÄ5779 "nginx: worker process"
```
### HQ-SRV
```bash
vim /var/www/webapps/moodle/config.php
$CFG->wwwroot   = 'http://moodle.au-team.irpo/moodle';
```
```bash
systemctl restart httpd2
```
### BR-SRV
```bash
docker compose -f wiki.yml down
```
```bash
mcedit LocalSettings.php
$wgServer = "http://wiki.au-team.irpo:8086";
```
```bash
docker compose -f wiki.yml up -d
```
### HQ-CLI
```bash
su -
toor
mcedit /etc/hosts # –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏
172.16.4.1      moodle.au-team.irpo moodle
172.16.5.1      wiki.au-team.irpo wiki
```
```bash
nmcli connection modify CLI-NET \
ipv4.ignore-auto-dns yes \
ipv4.dns 192.168.3.10
```
```bash
nmcli connection down CLI-NET
nmcli connection up CLI-NET
```
**–û—Ç–∫—Ä—ã–≤–∞–µ–º Firefox:**
- –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ http://moodle.au-team.irpo/moodle
- –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ http://wiki.au-team.irpo:8086

> ‚ö†Ô∏è üí° **–í–∞–∂–Ω–æ**: –ï—Å–ª–∏ –æ–±–∞ —Å–∞–π—Ç–∞ –æ—Ç–∫—Ä—ã–ª–∏—Å—å –±–µ–∑ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –Ω–∞ http://hq-srv.au-team.irpo/moodle –∏ 192.168.3.10:8086 (–∞–¥—Ä–µ—Å –≤ —Å—Ç—Ä–æ–∫–µ –ø–æ–∏—Å–∫–∞ –æ—Å—Ç–∞–ª—Å—è —Ç–æ—Ç –∂–µ), –∑–Ω–∞—á–∏—Ç –≤—Å–µ –≤—ã–ø–æ–ª–µ–Ω–µ–Ω–æ –≤–µ—Ä–Ω–æ.

**–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —ç–∫–∑–∞–º–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω, –≥–æ—Ç–æ–≤—ã–π –æ—Ç—á–µ—Ç –º–æ–∂–Ω–æ –≤–∑—è—Ç—å [—Ç—É—Ç.](./report_2025.docx)**
